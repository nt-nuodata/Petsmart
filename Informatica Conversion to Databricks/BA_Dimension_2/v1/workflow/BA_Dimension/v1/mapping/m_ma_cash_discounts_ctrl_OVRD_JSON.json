{"Edges":[{"transformationType":"Source Definition","id":"e-0","source":"","target":"USR_MA_CASH_DISCOUNT_OVRD_CTRL"},{"transformationType":"Source Qualifier","id":"e-1","source":"USR_MA_CASH_DISCOUNT_OVRD_CTRL","target":"SQ_Shortcut_to_USR_MA_CASH_DISCOUNT_OVRD_CTRL"},{"transformationType":"Source Definition","id":"e-2","source":"","target":"MA_CASH_DISCOUNT_CTRL"},{"transformationType":"Source Qualifier","id":"e-3","source":"MA_CASH_DISCOUNT_CTRL","target":"SQ_Shortcut_to_MA_CASH_DISCOUNT_CTRL"},{"transformationType":"Joiner","id":"e-4","source":"SQ_Shortcut_to_USR_MA_CASH_DISCOUNT_OVRD_CTRL","target":"JNR_MA_CASH_DISCOUNT_OVRD"},{"transformationType":"Joiner","id":"e-5","source":"SQ_Shortcut_to_MA_CASH_DISCOUNT_CTRL","target":"JNR_MA_CASH_DISCOUNT_OVRD"},{"transformationType":"Expression","id":"e-6","source":"JNR_MA_CASH_DISCOUNT_OVRD","target":"EXP_OVRD_CASH_DISCOUNT_PCT"},{"transformationType":"Filter","id":"e-7","source":"EXP_OVRD_CASH_DISCOUNT_PCT","target":"FIL_INS_UPD_FLAG"},{"transformationType":"Sorter","id":"e-8","source":"FIL_INS_UPD_FLAG","target":"SRT_DISTINCT"},{"transformationType":"Update Strategy","id":"e-9","source":"SRT_DISTINCT","target":"UPD_STRATEGY"},{"transformationType":"Target Definition","id":"e-10","source":"UPD_STRATEGY","target":"MA_CASH_DISCOUNT_CTRL"}],"Nodes":[{"data":{"transformationType":"Source Definition","label":"USR_MA_CASH_DISCOUNT_OVRD_CTRL","queries":["df_0=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        SOURCE_VENDOR_ID AS SOURCE_VENDOR_ID,\n        OVRD_CASH_DISCOUNT_PCT AS OVRD_CASH_DISCOUNT_PCT,\n        monotonically_increasing_id() AS Monotonically_Increasing_Id \n    FROM\n        USR_MA_CASH_DISCOUNT_OVRD_CTRL\"\"\")","df_0.createOrReplaceTempView(\"USR_MA_CASH_DISCOUNT_OVRD_CTRL_0\")"]},"id":"USR_MA_CASH_DISCOUNT_OVRD_CTRL","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Qualifier","label":"SQ_Shortcut_to_USR_MA_CASH_DISCOUNT_OVRD_CTRL","queries":["df_1=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        SOURCE_VENDOR_ID AS SOURCE_VENDOR_ID,\n        OVRD_CASH_DISCOUNT_PCT AS OVRD_CASH_DISCOUNT_PCT,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        USR_MA_CASH_DISCOUNT_OVRD_CTRL_0\"\"\")","df_1.createOrReplaceTempView(\"SQ_Shortcut_to_USR_MA_CASH_DISCOUNT_OVRD_CTRL_1\")"]},"id":"SQ_Shortcut_to_USR_MA_CASH_DISCOUNT_OVRD_CTRL","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Definition","label":"MA_CASH_DISCOUNT_CTRL","queries":["df_2=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        SOURCE_VENDOR_ID AS SOURCE_VENDOR_ID,\n        EST_CASH_DISCOUNT_PCT AS EST_CASH_DISCOUNT_PCT,\n        ACT_NET_SALES_COST AS ACT_NET_SALES_COST,\n        ACT_CASH_DISCOUNT_GL_AMT AS ACT_CASH_DISCOUNT_GL_AMT,\n        ACT_CASH_DISCOUNT_PCT AS ACT_CASH_DISCOUNT_PCT,\n        OVRD_CASH_DISCOUNT_PCT AS OVRD_CASH_DISCOUNT_PCT,\n        UPDATE_TSTMP AS UPDATE_TSTMP,\n        LOAD_TSTMP AS LOAD_TSTMP,\n        monotonically_increasing_id() AS Monotonically_Increasing_Id \n    FROM\n        MA_CASH_DISCOUNT_CTRL\"\"\")","df_2.createOrReplaceTempView(\"MA_CASH_DISCOUNT_CTRL_2\")"]},"id":"MA_CASH_DISCOUNT_CTRL","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Qualifier","label":"SQ_Shortcut_to_MA_CASH_DISCOUNT_CTRL","queries":["df_3=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        SOURCE_VENDOR_ID AS SOURCE_VENDOR_ID,\n        OVRD_CASH_DISCOUNT_PCT AS OVRD_CASH_DISCOUNT_PCT,\n        LOAD_TSTMP AS LOAD_TSTMP,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        MA_CASH_DISCOUNT_CTRL_2\"\"\")","df_3.createOrReplaceTempView(\"SQ_Shortcut_to_MA_CASH_DISCOUNT_CTRL_3\")"]},"id":"SQ_Shortcut_to_MA_CASH_DISCOUNT_CTRL","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Joiner","label":"JNR_MA_CASH_DISCOUNT_OVRD","queries":["df_4=spark.sql(\"\"\"\n    SELECT\n        MASTER.FISCAL_MO AS FISCAL_MO1,\n        MASTER.SOURCE_VENDOR_ID AS SOURCE_VENDOR_ID1,\n        MASTER.OVRD_CASH_DISCOUNT_PCT AS OVRD_CASH_DISCOUNT_PCT1,\n        DETAIL.FISCAL_MO AS FISCAL_MO,\n        DETAIL.SOURCE_VENDOR_ID AS SOURCE_VENDOR_ID,\n        DETAIL.OVRD_CASH_DISCOUNT_PCT AS OVRD_CASH_DISCOUNT_PCT,\n        DETAIL.LOAD_TSTMP AS LOAD_TSTMP,\n        MASTER.Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        SQ_Shortcut_to_USR_MA_CASH_DISCOUNT_OVRD_CTRL_1 MASTER \n    LEFT JOIN\n        SQ_Shortcut_to_MA_CASH_DISCOUNT_CTRL_3 DETAIL \n            ON MASTER.FISCAL_MO = FISCAL_MO \n            AND SOURCE_VENDOR_ID1 = DETAIL.SOURCE_VENDOR_ID\"\"\")","df_4.createOrReplaceTempView(\"JNR_MA_CASH_DISCOUNT_OVRD_4\")"]},"id":"JNR_MA_CASH_DISCOUNT_OVRD","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Joiner","label":"JNR_MA_CASH_DISCOUNT_OVRD","queries":["df_4=spark.sql(\"\"\"\n    SELECT\n        MASTER.FISCAL_MO AS FISCAL_MO1,\n        MASTER.SOURCE_VENDOR_ID AS SOURCE_VENDOR_ID1,\n        MASTER.OVRD_CASH_DISCOUNT_PCT AS OVRD_CASH_DISCOUNT_PCT1,\n        DETAIL.FISCAL_MO AS FISCAL_MO,\n        DETAIL.SOURCE_VENDOR_ID AS SOURCE_VENDOR_ID,\n        DETAIL.OVRD_CASH_DISCOUNT_PCT AS OVRD_CASH_DISCOUNT_PCT,\n        DETAIL.LOAD_TSTMP AS LOAD_TSTMP,\n        MASTER.Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        SQ_Shortcut_to_USR_MA_CASH_DISCOUNT_OVRD_CTRL_1 MASTER \n    LEFT JOIN\n        SQ_Shortcut_to_MA_CASH_DISCOUNT_CTRL_3 DETAIL \n            ON MASTER.FISCAL_MO = FISCAL_MO \n            AND SOURCE_VENDOR_ID1 = DETAIL.SOURCE_VENDOR_ID\"\"\")","df_4.createOrReplaceTempView(\"JNR_MA_CASH_DISCOUNT_OVRD_4\")"]},"id":"JNR_MA_CASH_DISCOUNT_OVRD","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Expression","label":"EXP_OVRD_CASH_DISCOUNT_PCT","queries":["df_5=spark.sql(\"\"\"\n    SELECT\n        OVRD_CASH_DISCOUNT_PCT1 AS OVRD_CASH_DISCOUNT_PCT1,\n        IFF(ISNULL(FISCAL_MO1),\n        FISCAL_MO,\n        FISCAL_MO1) AS FISCAL_MO,\n        IFF(ISNULL(SOURCE_VENDOR_ID1),\n        SOURCE_VENDOR_ID,\n        SOURCE_VENDOR_ID1) AS SOURCE_VENDOR_ID,\n        current_timestamp AS UPDATE_TSTMP,\n        IFF(ISNULL(LOAD_TSTMP),\n        current_timestamp,\n        LOAD_TSTMP) AS LOAD_TSTMP,\n        IFF(ISNULL(FISCAL_MO),\n        'I',\n        IFF(IFF(ISNULL(OVRD_CASH_DISCOUNT_PCT1),\n        -99,\n        OVRD_CASH_DISCOUNT_PCT1) <> IFF(ISNULL(OVRD_CASH_DISCOUNT_PCT),\n        -99,\n        OVRD_CASH_DISCOUNT_PCT),\n        'U',\n        'X')) AS INS_UPD_FLAG,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        JNR_MA_CASH_DISCOUNT_OVRD_4\"\"\")","df_5.createOrReplaceTempView(\"EXP_OVRD_CASH_DISCOUNT_PCT_5\")"]},"id":"EXP_OVRD_CASH_DISCOUNT_PCT","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Filter","label":"FIL_INS_UPD_FLAG","queries":["df_6=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        SOURCE_VENDOR_ID AS SOURCE_VENDOR_ID,\n        OVRD_CASH_DISCOUNT_PCT1 AS OVRD_CASH_DISCOUNT_PCT1,\n        UPDATE_TSTMP AS UPDATE_TSTMP,\n        LOAD_TSTMP AS LOAD_TSTMP,\n        INS_UPD_FLAG AS INS_UPD_FLAG,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        EXP_OVRD_CASH_DISCOUNT_PCT_5 \n    WHERE\n        INS_UPD_FLAG <> 'X'\"\"\")","df_6.createOrReplaceTempView(\"FIL_INS_UPD_FLAG_6\")"]},"id":"FIL_INS_UPD_FLAG","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Sorter","label":"SRT_DISTINCT","queries":["df_7=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        SOURCE_VENDOR_ID AS SOURCE_VENDOR_ID,\n        OVRD_CASH_DISCOUNT_PCT1 AS OVRD_CASH_DISCOUNT_PCT1,\n        UPDATE_TSTMP AS UPDATE_TSTMP,\n        LOAD_TSTMP AS LOAD_TSTMP,\n        INS_UPD_FLAG AS INS_UPD_FLAG,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        FIL_INS_UPD_FLAG_6 \n    ORDER BY\n        FISCAL_MO ASC,\n        SOURCE_VENDOR_ID ASC,\n        OVRD_CASH_DISCOUNT_PCT1 ASC,\n        UPDATE_TSTMP ASC,\n        LOAD_TSTMP ASC,\n        INS_UPD_FLAG ASC\"\"\")","df_7.createOrReplaceTempView(\"SRT_DISTINCT_7\")"]},"id":"SRT_DISTINCT","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Update Strategy","label":"UPD_STRATEGY","queries":["df_8=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        SOURCE_VENDOR_ID AS SOURCE_VENDOR_ID,\n        OVRD_CASH_DISCOUNT_PCT1 AS OVRD_CASH_DISCOUNT_PCT1,\n        UPDATE_TSTMP AS UPDATE_TSTMP,\n        LOAD_TSTMP AS LOAD_TSTMP,\n        INS_UPD_FLAG AS INS_UPD_FLAG,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        SRT_DISTINCT_7\"\"\")","df_8.createOrReplaceTempView(\"UPD_STRATEGY_8\")"]},"id":"UPD_STRATEGY","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Target Definition","label":"MA_CASH_DISCOUNT_CTRL","queries":["spark.sql(\"\"\"INSERT INTO MA_CASH_DISCOUNT_CTRL SELECT FISCAL_MO AS FISCAL_MO,\nSOURCE_VENDOR_ID AS SOURCE_VENDOR_ID,\nEST_CASH_DISCOUNT_PCT AS EST_CASH_DISCOUNT_PCT,\nACT_NET_SALES_COST AS ACT_NET_SALES_COST,\nACT_CASH_DISCOUNT_GL_AMT AS ACT_CASH_DISCOUNT_GL_AMT,\nACT_CASH_DISCOUNT_PCT AS ACT_CASH_DISCOUNT_PCT,\nOVRD_CASH_DISCOUNT_PCT1 AS OVRD_CASH_DISCOUNT_PCT,\nUPDATE_TSTMP AS UPDATE_TSTMP,\nLOAD_TSTMP AS LOAD_TSTMP FROM UPD_STRATEGY_8\"\"\")"]},"id":"MA_CASH_DISCOUNT_CTRL","position":{"x":0,"y":0},"type":"normalNode"}]}