{"Edges":[{"transformationType":"Source Definition","id":"e-0","source":"","target":"MA_CASH_DISCOUNT_CTRL"},{"transformationType":"Source Qualifier","id":"e-1","source":"MA_CASH_DISCOUNT_CTRL","target":"SQ_Shortcut_to_MA_CASH_DISCOUNT_CTRL"},{"transformationType":"Source Definition","id":"e-2","source":"","target":"VENDOR_PROFILE_RPT"},{"transformationType":"Source Definition","id":"e-3","source":"","target":"SALES_DAY_SKU_STORE_RPT"},{"transformationType":"Source Qualifier","id":"e-4","source":"SALES_DAY_SKU_STORE_RPT","target":"SQ_EST_CASH_DISCOUNT_PCT"},{"transformationType":"Source Qualifier","id":"e-5","source":"VENDOR_PROFILE_RPT","target":"SQ_EST_CASH_DISCOUNT_PCT"},{"transformationType":"Expression","id":"e-6","source":"SQ_EST_CASH_DISCOUNT_PCT","target":"EXP_VENDOR_ID"},{"transformationType":"Filter","id":"e-7","source":"EXP_VENDOR_ID","target":"FTR_REMOVE_INVALID"},{"transformationType":"Source Definition","id":"e-8","source":"","target":"DAYS"},{"transformationType":"Source Qualifier","id":"e-9","source":"DAYS","target":"SQ_Shortcut_To_DAYS"},{"transformationType":"Expression","id":"e-10","source":"SQ_Shortcut_To_DAYS","target":"EXP_FLAG"},{"transformationType":"Joiner","id":"e-11","source":"EXP_FLAG","target":"JNR_CROSS_JOIN"},{"transformationType":"Joiner","id":"e-12","source":"FTR_REMOVE_INVALID","target":"JNR_CROSS_JOIN"},{"transformationType":"Joiner","id":"e-13","source":"SQ_Shortcut_to_MA_CASH_DISCOUNT_CTRL","target":"JNR_MA_CASH_DISCOUNT_CTRL"},{"transformationType":"Joiner","id":"e-14","source":"JNR_CROSS_JOIN","target":"JNR_MA_CASH_DISCOUNT_CTRL"},{"transformationType":"Expression","id":"e-15","source":"JNR_MA_CASH_DISCOUNT_CTRL","target":"EXP_INS_UPD_FLAG"},{"transformationType":"Filter","id":"e-16","source":"EXP_INS_UPD_FLAG","target":"FIL_INS_UPD_FLAG"},{"transformationType":"Sorter","id":"e-17","source":"FIL_INS_UPD_FLAG","target":"SRT_DISTINCT"},{"transformationType":"Update Strategy","id":"e-18","source":"SRT_DISTINCT","target":"UPD_STRATEGY"},{"transformationType":"Target Definition","id":"e-19","source":"UPD_STRATEGY","target":"MA_CASH_DISCOUNT_CTRL"}],"Nodes":[{"data":{"transformationType":"Source Definition","label":"MA_CASH_DISCOUNT_CTRL","queries":["df_0=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        SOURCE_VENDOR_ID AS SOURCE_VENDOR_ID,\n        EST_CASH_DISCOUNT_PCT AS EST_CASH_DISCOUNT_PCT,\n        ACT_NET_SALES_COST AS ACT_NET_SALES_COST,\n        ACT_CASH_DISCOUNT_GL_AMT AS ACT_CASH_DISCOUNT_GL_AMT,\n        ACT_CASH_DISCOUNT_PCT AS ACT_CASH_DISCOUNT_PCT,\n        OVRD_CASH_DISCOUNT_PCT AS OVRD_CASH_DISCOUNT_PCT,\n        UPDATE_TSTMP AS UPDATE_TSTMP,\n        LOAD_TSTMP AS LOAD_TSTMP,\n        monotonically_increasing_id() AS Monotonically_Increasing_Id \n    FROM\n        MA_CASH_DISCOUNT_CTRL\"\"\")","df_0.createOrReplaceTempView(\"MA_CASH_DISCOUNT_CTRL_0\")"]},"id":"MA_CASH_DISCOUNT_CTRL","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Qualifier","label":"SQ_Shortcut_to_MA_CASH_DISCOUNT_CTRL","queries":["df_1=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        SOURCE_VENDOR_ID AS SOURCE_VENDOR_ID,\n        EST_CASH_DISCOUNT_PCT AS EST_CASH_DISCOUNT_PCT,\n        LOAD_TSTMP AS LOAD_TSTMP,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        MA_CASH_DISCOUNT_CTRL_0\"\"\")","df_1.createOrReplaceTempView(\"SQ_Shortcut_to_MA_CASH_DISCOUNT_CTRL_1\")"]},"id":"SQ_Shortcut_to_MA_CASH_DISCOUNT_CTRL","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Definition","label":"VENDOR_PROFILE_RPT","queries":["df_2=spark.sql(\"\"\"\n    SELECT\n        VENDOR_ID AS VENDOR_ID,\n        VENDOR_NAME AS VENDOR_NAME,\n        VENDOR_TYPE_ID AS VENDOR_TYPE_ID,\n        VENDOR_TYPE_DESC AS VENDOR_TYPE_DESC,\n        VENDOR_NBR AS VENDOR_NBR,\n        LOCATION_ID AS LOCATION_ID,\n        PARENT_VENDOR_ID AS PARENT_VENDOR_ID,\n        PARENT_VENDOR_NAME AS PARENT_VENDOR_NAME,\n        PURCH_GROUP_ID AS PURCH_GROUP_ID,\n        PURCH_GROUP_NAME AS PURCH_GROUP_NAME,\n        MGR_ID AS MGR_ID,\n        MGR_DESC AS MGR_DESC,\n        DVL_ID AS DVL_ID,\n        DVL_DESC AS DVL_DESC,\n        EDI_ELIG_FLAG AS EDI_ELIG_FLAG,\n        PAYMENT_TERM_CD AS PAYMENT_TERM_CD,\n        PAYMENT_TERM_DESC AS PAYMENT_TERM_DESC,\n        INCO_TERM_CD AS INCO_TERM_CD,\n        INCO_TERM_DESC AS INCO_TERM_DESC,\n        ADDRESS AS ADDRESS,\n        CITY AS CITY,\n        STATE AS STATE,\n        STATE_NAME AS STATE_NAME,\n        COUNTRY_CD AS COUNTRY_CD,\n        COUNTRY_NAME AS COUNTRY_NAME,\n        ZIP AS ZIP,\n        CONTACT AS CONTACT,\n        CONTACT_PHONE AS CONTACT_PHONE,\n        PHONE AS PHONE,\n        PHONE_EXT AS PHONE_EXT,\n        FAX AS FAX,\n        RTV_ELIG_FLAG AS RTV_ELIG_FLAG,\n        RTV_TYPE_CD AS RTV_TYPE_CD,\n        RTV_TYPE_DESC AS RTV_TYPE_DESC,\n        RTV_FREIGHT_TYPE_CD AS RTV_FREIGHT_TYPE_CD,\n        INDUSTRY_CD AS INDUSTRY_CD,\n        LATITUDE AS LATITUDE,\n        LONGITUDE AS LONGITUDE,\n        TIME_ZONE_ID AS TIME_ZONE_ID,\n        ADD_DT AS ADD_DT,\n        UPDATE_DT AS UPDATE_DT,\n        LOAD_DT AS LOAD_DT,\n        monotonically_increasing_id() AS Monotonically_Increasing_Id \n    FROM\n        VENDOR_PROFILE_RPT\"\"\")","df_2.createOrReplaceTempView(\"VENDOR_PROFILE_RPT_2\")"]},"id":"VENDOR_PROFILE_RPT","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Definition","label":"SALES_DAY_SKU_STORE_RPT","queries":["df_3=spark.sql(\"\"\"\n    SELECT\n        DAY_DT AS DAY_DT,\n        PRODUCT_ID AS PRODUCT_ID,\n        LOCATION_ID AS LOCATION_ID,\n        SALES_CUST_CAPTURE_CD AS SALES_CUST_CAPTURE_CD,\n        WEEK_DT AS WEEK_DT,\n        FISCAL_YR AS FISCAL_YR,\n        SKU_NBR AS SKU_NBR,\n        STORE_NBR AS STORE_NBR,\n        OPT_SALES_TYPE_ID AS OPT_SALES_TYPE_ID,\n        VENDOR_ID AS VENDOR_ID,\n        PROMO_FLAG AS PROMO_FLAG,\n        STATUS_ID AS STATUS_ID,\n        BRAND_NAME AS BRAND_NAME,\n        OWNBRAND_FLAG AS OWNBRAND_FLAG,\n        SKU_VEND_TXN_CNT AS SKU_VEND_TXN_CNT,\n        NET_SALES_AMT AS NET_SALES_AMT,\n        NET_SALES_QTY AS NET_SALES_QTY,\n        NET_MARGIN_AMT AS NET_MARGIN_AMT,\n        SALES_AMT AS SALES_AMT,\n        SALES_COST AS SALES_COST,\n        SALES_QTY AS SALES_QTY,\n        RETURN_AMT AS RETURN_AMT,\n        RETURN_COST AS RETURN_COST,\n        RETURN_QTY AS RETURN_QTY,\n        CLEARANCE_AMT AS CLEARANCE_AMT,\n        CLEARANCE_QTY AS CLEARANCE_QTY,\n        CLEARANCE_RETURN_AMT AS CLEARANCE_RETURN_AMT,\n        CLEARANCE_RETURN_QTY AS CLEARANCE_RETURN_QTY,\n        DISCOUNT_AMT AS DISCOUNT_AMT,\n        DISCOUNT_QTY AS DISCOUNT_QTY,\n        DISCOUNT_RETURN_AMT AS DISCOUNT_RETURN_AMT,\n        DISCOUNT_RETURN_QTY AS DISCOUNT_RETURN_QTY,\n        POS_COUPON_AMT AS POS_COUPON_AMT,\n        POS_COUPON_QTY AS POS_COUPON_QTY,\n        SPECIAL_SALES_AMT AS SPECIAL_SALES_AMT,\n        SPECIAL_SALES_QTY AS SPECIAL_SALES_QTY,\n        SPECIAL_RETURN_AMT AS SPECIAL_RETURN_AMT,\n        SPECIAL_RETURN_QTY AS SPECIAL_RETURN_QTY,\n        SPECIAL_SRVC_AMT AS SPECIAL_SRVC_AMT,\n        SPECIAL_SRVC_QTY AS SPECIAL_SRVC_QTY,\n        MA_SALES_AMT AS MA_SALES_AMT,\n        MA_SALES_QTY AS MA_SALES_QTY,\n        MA_TRANS_AMT AS MA_TRANS_AMT,\n        MA_TRANS_COST AS MA_TRANS_COST,\n        MA_TRANS_QTY AS MA_TRANS_QTY,\n        EXCH_RATE_PCT AS EXCH_RATE_PCT,\n        UPDATE_DT AS UPDATE_DT,\n        LOAD_DT AS LOAD_DT,\n        monotonically_increasing_id() AS Monotonically_Increasing_Id \n    FROM\n        SALES_DAY_SKU_STORE_RPT\"\"\")","df_3.createOrReplaceTempView(\"SALES_DAY_SKU_STORE_RPT_3\")"]},"id":"SALES_DAY_SKU_STORE_RPT","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Qualifier","label":"SQ_EST_CASH_DISCOUNT_PCT","queries":["df_4=spark.sql(\"\"\"\n    SELECT\n        DISTINCT V.VENDOR_ID,\n        SUBSTR(V.PAYMENT_TERM_DESC,\n        1,\n        INSTR(V.PAYMENT_TERM_DESC,\n        '%') - 1) TXT_EST_CASH_DISCOUNT_PCT \n    FROM\n        VENDOR_PROFILE_RPT V \n    JOIN\n        SALES_DAY_SKU_STORE_RPT S \n            ON V.VENDOR_ID = S.VENDOR_ID \n    WHERE\n        S.DAY_DT >= CURRENT_DATE - 36 \n        AND NVL(TXT_EST_CASH_DISCOUNT_PCT, '') <> ''\"\"\")","df_4.createOrReplaceTempView(\"SQ_EST_CASH_DISCOUNT_PCT_4\")"]},"id":"SQ_EST_CASH_DISCOUNT_PCT","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Qualifier","label":"SQ_EST_CASH_DISCOUNT_PCT","queries":["df_4=spark.sql(\"\"\"\n    SELECT\n        DISTINCT V.VENDOR_ID,\n        SUBSTR(V.PAYMENT_TERM_DESC,\n        1,\n        INSTR(V.PAYMENT_TERM_DESC,\n        '%') - 1) TXT_EST_CASH_DISCOUNT_PCT \n    FROM\n        VENDOR_PROFILE_RPT V \n    JOIN\n        SALES_DAY_SKU_STORE_RPT S \n            ON V.VENDOR_ID = S.VENDOR_ID \n    WHERE\n        S.DAY_DT >= CURRENT_DATE - 36 \n        AND NVL(TXT_EST_CASH_DISCOUNT_PCT, '') <> ''\"\"\")","df_4.createOrReplaceTempView(\"SQ_EST_CASH_DISCOUNT_PCT_4\")"]},"id":"SQ_EST_CASH_DISCOUNT_PCT","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Expression","label":"EXP_VENDOR_ID","queries":["df_5=spark.sql(\"\"\"\n    SELECT\n        VENDOR_ID AS VENDOR_ID,\n        IFF(IS_NUMBER(TXT_EST_CASH_DISCOUNT_PCT),\n        TO_DECIMAL(TXT_EST_CASH_DISCOUNT_PCT) * .01,\n        0) AS THIS_EST_CASH_DISCOUNT_PCT,\n        1 AS FLAG,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        SQ_EST_CASH_DISCOUNT_PCT_4\"\"\")","df_5.createOrReplaceTempView(\"EXP_VENDOR_ID_5\")"]},"id":"EXP_VENDOR_ID","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Filter","label":"FTR_REMOVE_INVALID","queries":["df_6=spark.sql(\"\"\"\n    SELECT\n        VENDOR_ID AS VENDOR_ID,\n        THIS_EST_CASH_DISCOUNT_PCT AS THIS_EST_CASH_DISCOUNT_PCT,\n        FLAG AS FLAG,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        EXP_VENDOR_ID_5 \n    WHERE\n        THIS_EST_CASH_DISCOUNT_PCT <> 0\"\"\")","df_6.createOrReplaceTempView(\"FTR_REMOVE_INVALID_6\")"]},"id":"FTR_REMOVE_INVALID","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Definition","label":"DAYS","queries":["df_7=spark.sql(\"\"\"\n    SELECT\n        DAY_DT AS DAY_DT,\n        BUSINESS_DAY_FLAG AS BUSINESS_DAY_FLAG,\n        HOLIDAY_FLAG AS HOLIDAY_FLAG,\n        DAY_OF_WK_NAME AS DAY_OF_WK_NAME,\n        DAY_OF_WK_NAME_ABBR AS DAY_OF_WK_NAME_ABBR,\n        DAY_OF_WK_NBR AS DAY_OF_WK_NBR,\n        CAL_DAY_OF_MO_NBR AS CAL_DAY_OF_MO_NBR,\n        CAL_DAY_OF_YR_NBR AS CAL_DAY_OF_YR_NBR,\n        CAL_WK AS CAL_WK,\n        CAL_WK_NBR AS CAL_WK_NBR,\n        CAL_MO AS CAL_MO,\n        CAL_MO_NBR AS CAL_MO_NBR,\n        CAL_MO_NAME AS CAL_MO_NAME,\n        CAL_MO_NAME_ABBR AS CAL_MO_NAME_ABBR,\n        CAL_QTR AS CAL_QTR,\n        CAL_QTR_NBR AS CAL_QTR_NBR,\n        CAL_HALF AS CAL_HALF,\n        CAL_YR AS CAL_YR,\n        FISCAL_DAY_OF_MO_NBR AS FISCAL_DAY_OF_MO_NBR,\n        FISCAL_DAY_OF_YR_NBR AS FISCAL_DAY_OF_YR_NBR,\n        FISCAL_WK AS FISCAL_WK,\n        FISCAL_WK_NBR AS FISCAL_WK_NBR,\n        FISCAL_MO AS FISCAL_MO,\n        FISCAL_MO_NBR AS FISCAL_MO_NBR,\n        FISCAL_MO_NAME AS FISCAL_MO_NAME,\n        FISCAL_MO_NAME_ABBR AS FISCAL_MO_NAME_ABBR,\n        FISCAL_QTR AS FISCAL_QTR,\n        FISCAL_QTR_NBR AS FISCAL_QTR_NBR,\n        FISCAL_HALF AS FISCAL_HALF,\n        FISCAL_YR AS FISCAL_YR,\n        LYR_WEEK_DT AS LYR_WEEK_DT,\n        LWK_WEEK_DT AS LWK_WEEK_DT,\n        WEEK_DT AS WEEK_DT,\n        EST_TIME_CONV_AMT AS EST_TIME_CONV_AMT,\n        EST_TIME_CONV_HRS AS EST_TIME_CONV_HRS,\n        ES0_TIME_CONV_AMT AS ES0_TIME_CONV_AMT,\n        ES0_TIME_CONV_HRS AS ES0_TIME_CONV_HRS,\n        CST_TIME_CONV_AMT AS CST_TIME_CONV_AMT,\n        CST_TIME_CONV_HRS AS CST_TIME_CONV_HRS,\n        CS0_TIME_CONV_AMT AS CS0_TIME_CONV_AMT,\n        CS0_TIME_CONV_HRS AS CS0_TIME_CONV_HRS,\n        MST_TIME_CONV_AMT AS MST_TIME_CONV_AMT,\n        MST_TIME_CONV_HRS AS MST_TIME_CONV_HRS,\n        MS0_TIME_CONV_AMT AS MS0_TIME_CONV_AMT,\n        MS0_TIME_CONV_HRS AS MS0_TIME_CONV_HRS,\n        PST_TIME_CONV_AMT AS PST_TIME_CONV_AMT,\n        PST_TIME_CONV_HRS AS PST_TIME_CONV_HRS,\n        monotonically_increasing_id() AS Monotonically_Increasing_Id \n    FROM\n        DAYS\"\"\")","df_7.createOrReplaceTempView(\"DAYS_7\")"]},"id":"DAYS","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Qualifier","label":"SQ_Shortcut_To_DAYS","queries":["df_8=spark.sql(\"\"\"\n    SELECT\n        DAY_DT AS DAY_DT,\n        FISCAL_MO AS FISCAL_MO,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        DAYS_7 \n    WHERE\n        DAYS.DAY_DT = CURRENT_DATE - 1\"\"\")","df_8.createOrReplaceTempView(\"SQ_Shortcut_To_DAYS_8\")"]},"id":"SQ_Shortcut_To_DAYS","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Expression","label":"EXP_FLAG","queries":["df_9=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        1 AS FLAG,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        SQ_Shortcut_To_DAYS_8\"\"\")","df_9.createOrReplaceTempView(\"EXP_FLAG_9\")"]},"id":"EXP_FLAG","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Joiner","label":"JNR_CROSS_JOIN","queries":["df_10=spark.sql(\"\"\"\n    SELECT\n        MASTER.VENDOR_ID AS VENDOR_ID,\n        MASTER.THIS_EST_CASH_DISCOUNT_PCT AS THIS_EST_CASH_DISCOUNT_PCT,\n        MASTER.FLAG AS FLAG,\n        DETAIL.FISCAL_MO AS FISCAL_MO,\n        DETAIL.FLAG AS FLAG1,\n        MASTER.Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        FTR_REMOVE_INVALID_6 MASTER \n    INNER JOIN\n        EXP_FLAG_9 DETAIL \n            ON MASTER.FLAG = DETAIL.FLAG\"\"\")","df_10.createOrReplaceTempView(\"JNR_CROSS_JOIN_10\")"]},"id":"JNR_CROSS_JOIN","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Joiner","label":"JNR_CROSS_JOIN","queries":["df_10=spark.sql(\"\"\"\n    SELECT\n        MASTER.VENDOR_ID AS VENDOR_ID,\n        MASTER.THIS_EST_CASH_DISCOUNT_PCT AS THIS_EST_CASH_DISCOUNT_PCT,\n        MASTER.FLAG AS FLAG,\n        DETAIL.FISCAL_MO AS FISCAL_MO,\n        DETAIL.FLAG AS FLAG1,\n        MASTER.Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        FTR_REMOVE_INVALID_6 MASTER \n    INNER JOIN\n        EXP_FLAG_9 DETAIL \n            ON MASTER.FLAG = DETAIL.FLAG\"\"\")","df_10.createOrReplaceTempView(\"JNR_CROSS_JOIN_10\")"]},"id":"JNR_CROSS_JOIN","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Joiner","label":"JNR_MA_CASH_DISCOUNT_CTRL","queries":["df_11=spark.sql(\"\"\"\n    SELECT\n        MASTER.VENDOR_ID AS VENDOR_ID,\n        MASTER.THIS_EST_CASH_DISCOUNT_PCT AS THIS_EST_CASH_DISCOUNT_PCT,\n        MASTER.FISCAL_MO AS FISCAL_MO1,\n        DETAIL.FISCAL_MO AS FISCAL_MO,\n        DETAIL.SOURCE_VENDOR_ID AS SOURCE_VENDOR_ID,\n        DETAIL.EST_CASH_DISCOUNT_PCT AS EST_CASH_DISCOUNT_PCT,\n        DETAIL.LOAD_TSTMP AS LOAD_TSTMP,\n        MASTER.Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        JNR_CROSS_JOIN_10 MASTER \n    RIGHT JOIN\n        SQ_Shortcut_to_MA_CASH_DISCOUNT_CTRL_1 DETAIL \n            ON MASTER.VENDOR_ID = SOURCE_VENDOR_ID \n            AND FISCAL_MO1 = DETAIL.FISCAL_MO\"\"\")","df_11.createOrReplaceTempView(\"JNR_MA_CASH_DISCOUNT_CTRL_11\")"]},"id":"JNR_MA_CASH_DISCOUNT_CTRL","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Joiner","label":"JNR_MA_CASH_DISCOUNT_CTRL","queries":["df_11=spark.sql(\"\"\"\n    SELECT\n        MASTER.VENDOR_ID AS VENDOR_ID,\n        MASTER.THIS_EST_CASH_DISCOUNT_PCT AS THIS_EST_CASH_DISCOUNT_PCT,\n        MASTER.FISCAL_MO AS FISCAL_MO1,\n        DETAIL.FISCAL_MO AS FISCAL_MO,\n        DETAIL.SOURCE_VENDOR_ID AS SOURCE_VENDOR_ID,\n        DETAIL.EST_CASH_DISCOUNT_PCT AS EST_CASH_DISCOUNT_PCT,\n        DETAIL.LOAD_TSTMP AS LOAD_TSTMP,\n        MASTER.Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        JNR_CROSS_JOIN_10 MASTER \n    RIGHT JOIN\n        SQ_Shortcut_to_MA_CASH_DISCOUNT_CTRL_1 DETAIL \n            ON MASTER.VENDOR_ID = SOURCE_VENDOR_ID \n            AND FISCAL_MO1 = DETAIL.FISCAL_MO\"\"\")","df_11.createOrReplaceTempView(\"JNR_MA_CASH_DISCOUNT_CTRL_11\")"]},"id":"JNR_MA_CASH_DISCOUNT_CTRL","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Expression","label":"EXP_INS_UPD_FLAG","queries":["df_12=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        VENDOR_ID AS VENDOR_ID,\n        THIS_EST_CASH_DISCOUNT_PCT AS THIS_EST_CASH_DISCOUNT_PCT,\n        current_timestamp AS UPDATE_TSTMP,\n        IFF(ISNULL(LOAD_TSTMP),\n        current_timestamp,\n        LOAD_TSTMP) AS LOAD_TSTMP,\n        IFF(ISNULL(FISCAL_MO),\n        'I',\n        IFF(THIS_EST_CASH_DISCOUNT_PCT <> v_EST_CASH_DISCOUNT_PCT,\n        'U',\n        'X')) AS INS_UPD_FLAG,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        JNR_MA_CASH_DISCOUNT_CTRL_11\"\"\")","df_12.createOrReplaceTempView(\"EXP_INS_UPD_FLAG_12\")"]},"id":"EXP_INS_UPD_FLAG","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Filter","label":"FIL_INS_UPD_FLAG","queries":["df_13=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        VENDOR_ID AS VENDOR_ID,\n        THIS_EST_CASH_DISCOUNT_PCT AS THIS_EST_CASH_DISCOUNT_PCT,\n        UPDATE_TSTMP AS UPDATE_TSTMP,\n        LOAD_TSTMP AS LOAD_TSTMP,\n        INS_UPD_FLAG AS INS_UPD_FLAG,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        EXP_INS_UPD_FLAG_12 \n    WHERE\n        INS_UPD_FLAG <> 'X'\"\"\")","df_13.createOrReplaceTempView(\"FIL_INS_UPD_FLAG_13\")"]},"id":"FIL_INS_UPD_FLAG","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Sorter","label":"SRT_DISTINCT","queries":["df_14=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        VENDOR_ID AS VENDOR_ID,\n        THIS_EST_CASH_DISCOUNT_PCT AS THIS_EST_CASH_DISCOUNT_PCT,\n        INS_UPD_FLAG AS INS_UPD_FLAG,\n        UPDATE_TSTMP AS UPDATE_TSTMP,\n        LOAD_TSTMP AS LOAD_TSTMP,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        FIL_INS_UPD_FLAG_13 \n    ORDER BY\n        FISCAL_MO ASC,\n        VENDOR_ID ASC,\n        THIS_EST_CASH_DISCOUNT_PCT ASC,\n        INS_UPD_FLAG ASC,\n        UPDATE_TSTMP ASC,\n        LOAD_TSTMP ASC\"\"\")","df_14.createOrReplaceTempView(\"SRT_DISTINCT_14\")"]},"id":"SRT_DISTINCT","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Update Strategy","label":"UPD_STRATEGY","queries":["df_15=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        VENDOR_ID AS VENDOR_ID,\n        THIS_EST_CASH_DISCOUNT_PCT AS THIS_EST_CASH_DISCOUNT_PCT,\n        UPDATE_TSTMP AS UPDATE_TSTMP,\n        LOAD_TSTMP AS LOAD_TSTMP,\n        INS_UPD_FLAG AS INS_UPD_FLAG,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        SRT_DISTINCT_14\"\"\")","df_15.createOrReplaceTempView(\"UPD_STRATEGY_15\")"]},"id":"UPD_STRATEGY","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Target Definition","label":"MA_CASH_DISCOUNT_CTRL","queries":["spark.sql(\"\"\"INSERT INTO MA_CASH_DISCOUNT_CTRL SELECT FISCAL_MO AS FISCAL_MO,\nSOURCE_VENDOR_ID AS SOURCE_VENDOR_ID,\nEST_CASH_DISCOUNT_PCT AS EST_CASH_DISCOUNT_PCT,\nACT_NET_SALES_COST AS ACT_NET_SALES_COST,\nACT_CASH_DISCOUNT_GL_AMT AS ACT_CASH_DISCOUNT_GL_AMT,\nACT_CASH_DISCOUNT_PCT AS ACT_CASH_DISCOUNT_PCT,\nOVRD_CASH_DISCOUNT_PCT1 AS OVRD_CASH_DISCOUNT_PCT,\nUPDATE_TSTMP AS UPDATE_TSTMP,\nLOAD_TSTMP AS LOAD_TSTMP FROM UPD_STRATEGY_15\"\"\")"]},"id":"MA_CASH_DISCOUNT_CTRL","position":{"x":0,"y":0},"type":"normalNode"}]}