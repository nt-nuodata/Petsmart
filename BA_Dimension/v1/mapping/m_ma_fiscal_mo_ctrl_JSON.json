{"Edges":[{"transformationType":"Source Definition","id":"e-0","source":"","target":"MA_FISCAL_MO_CTRL"},{"transformationType":"Source Qualifier","id":"e-1","source":"MA_FISCAL_MO_CTRL","target":"SQ_Shortcut_to_MA_FISCAL_MO_CTRL"},{"transformationType":"Source Definition","id":"e-2","source":"","target":"DAYS"},{"transformationType":"Source Qualifier","id":"e-3","source":"DAYS","target":"SQ_Shortcut_To_DAYS"},{"transformationType":"Expression","id":"e-4","source":"SQ_Shortcut_To_DAYS","target":"EXP_FISCAL_MO"},{"transformationType":"Joiner","id":"e-5","source":"EXP_FISCAL_MO","target":"JNR_FISCAL_MO"},{"transformationType":"Joiner","id":"e-6","source":"SQ_Shortcut_to_MA_FISCAL_MO_CTRL","target":"JNR_FISCAL_MO"},{"transformationType":"Expression","id":"e-7","source":"JNR_FISCAL_MO","target":"EXP_INS_UPD_FLAG"},{"transformationType":"Update Strategy","id":"e-8","source":"EXP_INS_UPD_FLAG","target":"UPD_STRATEGY"},{"transformationType":"Target Definition","id":"e-9","source":"UPD_STRATEGY","target":"MA_FISCAL_MO_CTRL"}],"Nodes":[{"data":{"transformationType":"Source Definition","label":"MA_FISCAL_MO_CTRL","queries":["df_0=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        RESTATE_DT AS RESTATE_DT,\n        UPDATE_TSTMP AS UPDATE_TSTMP,\n        LOAD_TSTMP AS LOAD_TSTMP,\n        monotonically_increasing_id() AS Monotonically_Increasing_Id \n    FROM\n        MA_FISCAL_MO_CTRL\"\"\")","df_0.createOrReplaceTempView(\"MA_FISCAL_MO_CTRL_0\")"]},"id":"MA_FISCAL_MO_CTRL","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Qualifier","label":"SQ_Shortcut_to_MA_FISCAL_MO_CTRL","queries":["df_1=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        LOAD_TSTMP AS LOAD_TSTMP,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        MA_FISCAL_MO_CTRL_0\"\"\")","df_1.createOrReplaceTempView(\"SQ_Shortcut_to_MA_FISCAL_MO_CTRL_1\")"]},"id":"SQ_Shortcut_to_MA_FISCAL_MO_CTRL","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Definition","label":"DAYS","queries":["df_2=spark.sql(\"\"\"\n    SELECT\n        DAY_DT AS DAY_DT,\n        BUSINESS_DAY_FLAG AS BUSINESS_DAY_FLAG,\n        HOLIDAY_FLAG AS HOLIDAY_FLAG,\n        DAY_OF_WK_NAME AS DAY_OF_WK_NAME,\n        DAY_OF_WK_NAME_ABBR AS DAY_OF_WK_NAME_ABBR,\n        DAY_OF_WK_NBR AS DAY_OF_WK_NBR,\n        CAL_DAY_OF_MO_NBR AS CAL_DAY_OF_MO_NBR,\n        CAL_DAY_OF_YR_NBR AS CAL_DAY_OF_YR_NBR,\n        CAL_WK AS CAL_WK,\n        CAL_WK_NBR AS CAL_WK_NBR,\n        CAL_MO AS CAL_MO,\n        CAL_MO_NBR AS CAL_MO_NBR,\n        CAL_MO_NAME AS CAL_MO_NAME,\n        CAL_MO_NAME_ABBR AS CAL_MO_NAME_ABBR,\n        CAL_QTR AS CAL_QTR,\n        CAL_QTR_NBR AS CAL_QTR_NBR,\n        CAL_HALF AS CAL_HALF,\n        CAL_YR AS CAL_YR,\n        FISCAL_DAY_OF_MO_NBR AS FISCAL_DAY_OF_MO_NBR,\n        FISCAL_DAY_OF_YR_NBR AS FISCAL_DAY_OF_YR_NBR,\n        FISCAL_WK AS FISCAL_WK,\n        FISCAL_WK_NBR AS FISCAL_WK_NBR,\n        FISCAL_MO AS FISCAL_MO,\n        FISCAL_MO_NBR AS FISCAL_MO_NBR,\n        FISCAL_MO_NAME AS FISCAL_MO_NAME,\n        FISCAL_MO_NAME_ABBR AS FISCAL_MO_NAME_ABBR,\n        FISCAL_QTR AS FISCAL_QTR,\n        FISCAL_QTR_NBR AS FISCAL_QTR_NBR,\n        FISCAL_HALF AS FISCAL_HALF,\n        FISCAL_YR AS FISCAL_YR,\n        LYR_WEEK_DT AS LYR_WEEK_DT,\n        LWK_WEEK_DT AS LWK_WEEK_DT,\n        WEEK_DT AS WEEK_DT,\n        EST_TIME_CONV_AMT AS EST_TIME_CONV_AMT,\n        EST_TIME_CONV_HRS AS EST_TIME_CONV_HRS,\n        ES0_TIME_CONV_AMT AS ES0_TIME_CONV_AMT,\n        ES0_TIME_CONV_HRS AS ES0_TIME_CONV_HRS,\n        CST_TIME_CONV_AMT AS CST_TIME_CONV_AMT,\n        CST_TIME_CONV_HRS AS CST_TIME_CONV_HRS,\n        CS0_TIME_CONV_AMT AS CS0_TIME_CONV_AMT,\n        CS0_TIME_CONV_HRS AS CS0_TIME_CONV_HRS,\n        MST_TIME_CONV_AMT AS MST_TIME_CONV_AMT,\n        MST_TIME_CONV_HRS AS MST_TIME_CONV_HRS,\n        MS0_TIME_CONV_AMT AS MS0_TIME_CONV_AMT,\n        MS0_TIME_CONV_HRS AS MS0_TIME_CONV_HRS,\n        PST_TIME_CONV_AMT AS PST_TIME_CONV_AMT,\n        PST_TIME_CONV_HRS AS PST_TIME_CONV_HRS,\n        monotonically_increasing_id() AS Monotonically_Increasing_Id \n    FROM\n        DAYS\"\"\")","df_2.createOrReplaceTempView(\"DAYS_2\")"]},"id":"DAYS","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Source Qualifier","label":"SQ_Shortcut_To_DAYS","queries":["df_3=spark.sql(\"\"\"\n    SELECT\n        DAY_DT AS DAY_DT,\n        DAY_OF_WK_NAME AS DAY_OF_WK_NAME,\n        FISCAL_MO AS FISCAL_MO,\n        FISCAL_MO_NBR AS FISCAL_MO_NBR,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        DAYS_2 \n    WHERE\n        DAYS.DAY_DT = CURRENT_DATE \n        AND DAYS.FISCAL_DAY_OF_MO_NBR = 7\"\"\")","df_3.createOrReplaceTempView(\"SQ_Shortcut_To_DAYS_3\")"]},"id":"SQ_Shortcut_To_DAYS","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Expression","label":"EXP_FISCAL_MO","queries":["df_4=spark.sql(\"\"\"\n    SELECT\n        RESTATE_DT AS RESTATE_DT,\n        IFF(FISCAL_MO_NBR = 1,\n        FISCAL_MO - 89,\n        FISCAL_MO - 1) AS FISCAL_MO,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        SQ_Shortcut_To_DAYS_3\"\"\")","df_4.createOrReplaceTempView(\"EXP_FISCAL_MO_4\")"]},"id":"EXP_FISCAL_MO","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Joiner","label":"JNR_FISCAL_MO","queries":["df_5=spark.sql(\"\"\"\n    SELECT\n        DETAIL.RESTATE_DT AS RESTATE_DT,\n        DETAIL.FISCAL_MO AS FISCAL_MO,\n        MASTER.FISCAL_MO AS FISCAL_MO1,\n        MASTER.LOAD_TSTMP AS LOAD_TSTMP,\n        MASTER.Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        SQ_Shortcut_to_MA_FISCAL_MO_CTRL_1 MASTER \n    LEFT JOIN\n        EXP_FISCAL_MO_4 DETAIL \n            ON MASTER.FISCAL_MO = DETAIL.FISCAL_MO\"\"\")","df_5.createOrReplaceTempView(\"JNR_FISCAL_MO_5\")"]},"id":"JNR_FISCAL_MO","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Joiner","label":"JNR_FISCAL_MO","queries":["df_5=spark.sql(\"\"\"\n    SELECT\n        DETAIL.RESTATE_DT AS RESTATE_DT,\n        DETAIL.FISCAL_MO AS FISCAL_MO,\n        MASTER.FISCAL_MO AS FISCAL_MO1,\n        MASTER.LOAD_TSTMP AS LOAD_TSTMP,\n        MASTER.Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        SQ_Shortcut_to_MA_FISCAL_MO_CTRL_1 MASTER \n    LEFT JOIN\n        EXP_FISCAL_MO_4 DETAIL \n            ON MASTER.FISCAL_MO = DETAIL.FISCAL_MO\"\"\")","df_5.createOrReplaceTempView(\"JNR_FISCAL_MO_5\")"]},"id":"JNR_FISCAL_MO","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Expression","label":"EXP_INS_UPD_FLAG","queries":["df_6=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        RESTATE_DT AS RESTATE_DT,\n        current_timestamp AS UPDATE_TSTMP,\n        IFF(ISNULL(LOAD_TSTMP),\n        current_timestamp,\n        LOAD_TSTMP) AS LOAD_TSTMP,\n        IFF(ISNULL(FISCAL_MO1),\n        'I',\n        'U') AS INS_UPD_FLAG,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        JNR_FISCAL_MO_5\"\"\")","df_6.createOrReplaceTempView(\"EXP_INS_UPD_FLAG_6\")"]},"id":"EXP_INS_UPD_FLAG","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Update Strategy","label":"UPD_STRATEGY","queries":["df_7=spark.sql(\"\"\"\n    SELECT\n        FISCAL_MO AS FISCAL_MO,\n        RESTATE_DT AS RESTATE_DT,\n        UPDATE_TSTMP AS UPDATE_TSTMP,\n        LOAD_TSTMP AS LOAD_TSTMP,\n        INS_UPD_FLAG AS INS_UPD_FLAG,\n        Monotonically_Increasing_Id AS Monotonically_Increasing_Id \n    FROM\n        EXP_INS_UPD_FLAG_6\"\"\")","df_7.createOrReplaceTempView(\"UPD_STRATEGY_7\")"]},"id":"UPD_STRATEGY","position":{"x":0,"y":0},"type":"normalNode"},{"data":{"transformationType":"Target Definition","label":"MA_FISCAL_MO_CTRL","queries":["spark.sql(\"\"\"INSERT INTO MA_FISCAL_MO_CTRL SELECT FISCAL_MO AS FISCAL_MO,\nRESTATE_DT AS RESTATE_DT,\nUPDATE_TSTMP AS UPDATE_TSTMP,\nLOAD_TSTMP AS LOAD_TSTMP FROM UPD_STRATEGY_7\"\"\")"]},"id":"MA_FISCAL_MO_CTRL","position":{"x":0,"y":0},"type":"normalNode"}]}